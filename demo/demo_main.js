(()=>{"use strict";var t,e={225:(t,e,i)=>{var s=i(899),a=i(75),n=i(471);class o{static initCamera(t,e,i){const s=new a.cPb(45,e/i,1,400);return s.position.set(0,0,100),t.add(s),s}static initLight(t){const e=new a.Mig(16777215,1);return t.add(e),e}static initHelper(t,e=30){const i=new a.y8_(e);t.add(i)}static initCube(t,e=5){const i=t=>new a.vBJ({color:t,opacity:.5,transparent:!0,wireframe:!0}),s=new a.DvJ(e,e,e),n=[i(65280),i(16711680),i(255),i(65280),i(16711680),i(255)],o=new a.Kj0(s,n);return t.add(o),o}static initRenderer(t,e,i=0,s="webgl-canvas",n=!0){const o=document.getElementById(s);o.style.zIndex=0,o.style.position="absolute";const r=new a.CP7({canvas:o,antialias:n});return r.setClearColor(new a.Ilk(i)),r.setSize(t,e),r.setPixelRatio(window.devicePixelRatio),r}static render(t,e,i){const s=()=>{t.render(e,i),requestAnimationFrame(s)};s()}}var r,h,c,p,l=i(554);class d{constructor(t,e){this.type=t,this.targetParam=e}}!function(t){t.MOVED_CAMERA="CameraEvent_TYPE_MOVED_CAMERA",t.MOVED_CAMERA_COMPLETE="CameraEvent_TYPE_MOVED_CAMERA_COMPLETE"}(r||(r={})),function(t){t.CAMERA_TARGET="cameraTarget",t.CAMERA_SHIFT="cameraShift"}(h||(h={})),function(t){t.R="radius",t.PHI="phi",t.THETA="theta"}(c||(c={}));class P{static init(t,e,i=!1){null==t&&(t=new P),t.duration=this.supplement(t.duration,e.tweens.duration);const s=i?e.tweens.loopEasing:e.tweens.easing;return t.easing=this.supplement(t.easing,s),t.normalize=this.supplement(t.normalize,!0),t}static supplement(t,e){return null==t?e:t}}class m{static getTweenTheta(t,e){e=this.PI2ToPI(e);let i=this.PI2ToPI(t);return i=this.PI2ToPI(e-i),t+i}static PI2ToPI(t){return Math.atan2(Math.sin(t),Math.cos(t))}static getFirstDuration(t,e,i,s){return Math.abs(t*((e-s)/(i-s)))}static generateCameraTarget(){const t=new a.Aip(1,3,3),e=new a.vBJ({color:16711680,opacity:0,transparent:!0});return new a.Kj0(t,e)}}class u{constructor(){this.phiMin=u.EPS,this.phiMax=Math.PI-u.EPS,this.thetaMin=null,this.thetaMax=null,this.rMax=Number.MAX_VALUE,this.rMin=u.EPS}setLimit(t,e,i){switch(t){case c.PHI:this.phiMax=e,this.phiMin=i;break;case c.THETA:this.thetaMax=e,this.thetaMin=i}}clampWithType(t,e){switch(t){case c.PHI:return u.clamp(e,this.phiMax,this.phiMin);case c.THETA:return u.clamp(e,this.thetaMax,this.thetaMin);case c.R:return u.clamp(e,this.rMax,this.rMin)}return e}clampPosition(t,e){const i=e[t];return this.clampWithType(t,i)}static clamp(t,e,i){return null==i||null==e?t:(t=Math.min(t,e),t=Math.max(t,i))}}u.EPS=1e-6;class w{constructor(){this.tweenMap=new Map,this.duration=1333,this.easing=n.oY.Cubic.Out,this.loopEasing=n.oY.Sinusoidal.InOut}stopTween(t){const e=this.tweenMap.get(t);e&&(e.stop(),this.tweenMap.delete(t))}overrideTween(t,e){this.stopTween(t),e&&this.tweenMap.set(t,e)}isPlaying(){let t=!1;return this.tweenMap.forEach(((e,i)=>{(null==e?void 0:e.isPlaying())&&(t=!0)})),t}isPlayingWithKey(t){var e;return null===(e=this.tweenMap.get(t))||void 0===e?void 0:e.isPlaying()}stop(){this.tweenMap.forEach(((t,e)=>{e&&this.stopTween(e)}))}}class T{constructor(t,e,i,s){this.type=t,this.cameraTarget=e,this.position=i,this.shift=s}}!function(t){t.UPDATE="CameraEvent_TYPE_UPDATE"}(p||(p={}));var g=i(163);class E{constructor(t,e){this.isUpdate=!1,this.setNeedUpdate=t=>{this.isUpdate=!0,this.updateEvent=t},this.updatePosition=()=>{if(!this.isUpdate)return;this.isUpdate=!1;const t=this.updateEvent,e=new a.Pa4,i=this._camera.position;if(i.setFromSpherical(t.position),i.add(t.cameraTarget.getWorldPosition(e)),this._camera.position.set(i.x,i.y,i.z),this._camera.lookAt(t.cameraTarget.getWorldPosition(e)),t.shift){const e=this._camera.position.clone(),i=new a.Pa4(t.shift.x,t.shift.y,t.shift.z);i.applyEuler(this._camera.rotation.clone()),e.add(i),this._camera.position.set(e.x,e.y,e.z)}this.dispatcher.dispatchEvent(new d(r.MOVED_CAMERA))},this.dispatcher=t,this._camera=e,this.dispatcher.addEventListener(p.UPDATE,this.setNeedUpdate),g.Fz.on(g.M9.onBeforeTick,(t=>{this.updatePosition()}))}}class M extends a.pBf{constructor(t,e){var i,s;super(),this.pos=new a.$V,this.cameraShift=new a.Pa4,this.tweens=new w,this.limiter=new u,this.dispatchUpdateEvent=()=>{const t=new T(p.UPDATE,this._cameraTarget,this.pos,this.cameraShift);this.dispatchEvent(t)},this._cameraTarget=e,null!==(i=(s=this._cameraTarget).material)&&void 0!==i||(s.material=new a.vBJ({color:16711680,opacity:0,transparent:!0})),this.cameraUpdater=new E(this,t),l.D.start()}initCameraPosition(t,e){this.pos=t;const i=this.limiter;this.pos.phi=i.clampPosition(c.PHI,this.pos),this.pos.theta=i.clampPosition(c.THETA,this.pos),this.pos.radius=i.clampPosition(c.R,this.pos),e&&this._cameraTarget.position.set(e.x,e.y,e.z),this.dispatchUpdateEvent()}initCameraShift(t){this.cameraShift=t.clone(),this.dispatchUpdateEvent()}move(t,e){e=P.init(e,this),this.tweens.stop(),this.movePosition(c.R,t.radius,e),this.movePosition(c.PHI,t.phi,e),this.movePosition(c.THETA,t.theta,e)}changeTarget(t){this._cameraTarget=t}movePosition(t,e,i){i=P.init(i,this),t===c.THETA&&i.normalize&&(e=m.getTweenTheta(this.pos.theta,e));const s=this.limiter.clampWithType(t,e);this.tweens.overrideTween(t,this.getTweenPosition(t,s,i))}getTweenPosition(t,e,i){const s={};return s[t]=e,new n.kX(this.pos).to(s,i.duration).easing(i.easing).onUpdate(this.dispatchUpdateEvent).onComplete((()=>{this.onCompleteCameraTween(t)})).start()}onCompleteCameraTween(t){this.dispatchEvent(new d(r.MOVED_CAMERA_COMPLETE,t))}moveTarget(t,e){e=P.init(e,this);const i=new n.kX(this._cameraTarget.position).to({x:t.x,y:t.y,z:t.z},e.duration).easing(e.easing).onUpdate(this.dispatchUpdateEvent).start();this.tweens.overrideTween(h.CAMERA_TARGET,i)}stopLoop(t){this.tweens.stopTween(t)}loop(t,e,i,s){t===c.THETA&&(this.pos.theta=m.PI2ToPI(this.pos.theta)),s=P.init(s,this,!0);const a=this.limiter.clampWithType(t,e),o=this.limiter.clampWithType(t,i),r={};r[t]=o;const h={};h[t]=a;const p=m.getFirstDuration(s.duration,this.pos[t],o,a),l=new n.kX(this.pos).easing(s.easing).to(h,p).onUpdate(this.dispatchUpdateEvent).onComplete((()=>{const e=new n.kX(this.pos).to(r,s.duration).yoyo(!0).easing(s.easing).onUpdate(this.dispatchUpdateEvent).repeat(1/0).start();this.tweens.overrideTween(t,e)})).start();this.tweens.overrideTween(t,l)}moveCameraShift(t,e){e=P.init(e,this);const i=new n.kX(this.cameraShift).easing(e.easing).to({x:t.x,y:t.y,z:t.z},e.duration).onUpdate(this.dispatchUpdateEvent).start();this.tweens.overrideTween(h.CAMERA_SHIFT,i)}addTargetPosition(t,e=!1){!e&&this.tweens.isPlaying()||(e&&this.tweens.isPlaying()&&this.tweens.stop(),this._cameraTarget.position.add(t),this.dispatchUpdateEvent())}addPosition(t,e,i=!1,s=!1){if(!i){if(!s&&this.tweens.isPlaying())return;if(s&&this.tweens.isPlayingWithKey(t))return}i&&this.tweens.isPlaying()&&this.tweens.stop(),this.pos[t]+=e,this.pos[t]=this.limiter.clampPosition(t,this.pos),this.dispatchUpdateEvent()}copySphericalPosition(t){return t.copy(this.pos)}cloneSphericalPosition(){return this.pos.clone()}}let v,I,_;let f;const y=(t,e)=>{const i={toggleRandomMove:()=>{null!=f?A(e):C(e)}};t.add(i,"toggleRandomMove")},A=t=>{t.tweens.stop(),clearInterval(f),f=null},C=t=>{const e=()=>{const e=new a.$V(105,Math.random()*Math.PI,Math.random()*Math.PI*6-3*Math.PI);t.move(e,{duration:1500,easing:n.ZP.Easing.Cubic.Out}),console.log("Start : ",e)};e(),f=setInterval(e,2e3)},U=(t,e)=>{const i=t.addFolder("add method");i.open(),x(c.R,5,i,e),x(c.R,-5,i,e),x(c.PHI,.1,i,e),x(c.PHI,-.1,i,e),x(c.THETA,.1,i,e),x(c.THETA,-.1,i,e)},x=(t,e,i,s)=>{const a={};let n=e.toString();e>0&&(n="+"+n);const o=t+n;a[o]=()=>{s.addPosition(t,e)},i.add(a,o)},R=(t,e)=>{const i=t.addFolder("loop method");i.open(),O(c.R,30,150,i,e),O(c.PHI,0,Math.PI,i,e),O(c.THETA,-Math.PI/4,Math.PI/4,i,e)},O=(t,e,i,s,a)=>{let n=!1;const o={duration:1e4},r="loop_"+t,h={};h[r]=()=>{n?a.stopLoop(t):a.loop(t,e,i,o),n=!n},s.add(h,r)};window.onload=()=>{I=new a.xsS,_=o.initCamera(I,1280,800),v=o.initRenderer(1280,800),o.initLight(I),console.log(0===m.PI2ToPI(0)),console.log(m.PI2ToPI(Math.PI)===Math.PI),console.log(m.PI2ToPI(-Math.PI)===-Math.PI),console.log(m.PI2ToPI(2*Math.PI)),console.log(m.PI2ToPI(Math.PI+.01)===.01-Math.PI),console.log(Math.abs(m.PI2ToPI(200*Math.PI+.01)-.01)<1e-6),o.initHelper(I),o.initCube(I);const t=m.generateCameraTarget();I.add(t);const e=((t,e)=>{const i=new M(_,t);return i.initCameraPosition(new a.$V(e,1e-4,2*Math.PI*12)),i.initCameraShift(new a.Pa4(20,0,0)),i.duration=1666,i.addEventListener(r.MOVED_CAMERA_COMPLETE,(t=>{console.log("Complete : ",t)})),i})(t,105);(t=>{setInterval((()=>{console.log(t.tweens.isPlaying())}),100)})(e),o.render(v,I,_),(t=>{const e=new s.ZP;y(e,t),U(e,t),R(e,t)})(e)}}},i={};function s(t){var a=i[t];if(void 0!==a)return a.exports;var n=i[t]={exports:{}};return e[t](n,n.exports,s),n.exports}s.m=e,t=[],s.O=(e,i,a,n)=>{if(!i){var o=1/0;for(p=0;p<t.length;p++){for(var[i,a,n]=t[p],r=!0,h=0;h<i.length;h++)(!1&n||o>=n)&&Object.keys(s.O).every((t=>s.O[t](i[h])))?i.splice(h--,1):(r=!1,n<o&&(o=n));if(r){t.splice(p--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var p=t.length;p>0&&t[p-1][2]>n;p--)t[p]=t[p-1];t[p]=[i,a,n]},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={177:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var a,n,[o,r,h]=i,c=0;if(o.some((e=>0!==t[e]))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(h)var p=h(s)}for(e&&e(i);c<o.length;c++)n=o[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(p)},i=self.webpackChunk_masatomakino_threejs_spherical_controls=self.webpackChunk_masatomakino_threejs_spherical_controls||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=s.O(void 0,[736],(()=>s(225)));a=s.O(a)})();