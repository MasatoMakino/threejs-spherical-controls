(()=>{"use strict";var t,e={782:(t,e,i)=>{var s=i(638),a=i(710),o=i(753),n=i(961),r=i(452),h=i(486);class c extends h.A{constructor(t,e){super(),this.pos=new a.YHV,this.cameraShift=new a.Pq0,this.tweens=new u,this.limiter=new m,this.onTick=t=>{this.tweens.update(t)},this.dispatchUpdateEvent=()=>{const t={type:"update",cameraTarget:this._cameraTarget,position:this.pos,shift:this.cameraShift};this.emit(t.type,t)},this._cameraTarget=e,this._cameraTarget.geometry||console.warn("No geometry for camera target object."),this.cameraUpdater=new l(this,t),n.w.on("tick",this.onTick)}initCameraPosition(t,e){this.pos.set(t.radius,t.phi,t.theta);const i=this.limiter;i.clampPosition("phi",this.pos),i.clampPosition("theta",this.pos),i.clampPosition("radius",this.pos),e&&this._cameraTarget.position.set(e.x,e.y,e.z),this.dispatchUpdateEvent()}initCameraShift(t){this.cameraShift=t.clone(),this.dispatchUpdateEvent()}move(t,e){const i=d.init(e,this);this.tweens.stop(),this.movePosition("radius",t.radius,i),this.movePosition("phi",t.phi,i),this.movePosition("theta",t.theta,i)}changeTarget(t){this._cameraTarget=t}movePosition(t,e,i){const s=d.init(i,this);let a=e;"theta"===t&&s.normalize&&(a=function(t,e){const i=p(e);let s=p(t);return s=p(i-s),t+s}(this.pos.theta,e));const o=this.limiter.clampWithType(t,a);this.tweens.overrideTween(t,this.getTweenPosition(t,o,s))}getTweenPosition(t,e,i){const s={};return s[t]=e,new r.K(this.pos).to(s,i.duration).easing(i.easing).onUpdate(this.dispatchUpdateEvent).onComplete((()=>{this.onCompleteCameraTween(t)})).start(i.startTime)}onCompleteCameraTween(t){this.emit("moved_camera_complete",{type:"moved_camera_complete",completedParam:t})}moveTarget(t,e){const i=d.init(e,this),s=new r.K(this._cameraTarget.position).to({x:t.x,y:t.y,z:t.z},i.duration).easing(i.easing).onUpdate(this.dispatchUpdateEvent).start(i.startTime);this.tweens.overrideTween("camera_target",s)}stopLoop(t){this.tweens.stopTween(t)}loop(t,e,i,s){"theta"===t&&(this.pos.theta=p(this.pos.theta));const a=d.init(s,this,!0),o=this.limiter.clampWithType(t,e),n=this.limiter.clampWithType(t,i),h={};h[t]=n;const c={};c[t]=o;const l=(e,i)=>{const s=null==i?void 0:i+a.duration,o=new r.K(this.pos).to(e,a.duration).easing(a.easing).onUpdate(this.dispatchUpdateEvent).onComplete((()=>{l(e===h?c:h,s)})).start(i);this.tweens.overrideTween(t,o)},m=function(t,e,i,s){const a=i-s;return 0===a?0:Math.abs(t*((e-s)/a))}(a.duration,this.pos[t],n,o),u=null==a.startTime?void 0:a.startTime+m,w=new r.K(this.pos).easing(a.easing).to(c,m).onUpdate(this.dispatchUpdateEvent).onComplete((()=>{l(h,u)})).start(a.startTime);this.tweens.overrideTween(t,w)}moveCameraShift(t,e){const i=d.init(e,this),s=new r.K(this.cameraShift).easing(i.easing).to({x:t.x,y:t.y,z:t.z},i.duration).onUpdate(this.dispatchUpdateEvent).start(i.startTime);this.tweens.overrideTween("camera_shift",s)}addTargetPosition(t,e=!1){!e&&this.tweens.isPlaying()||(e&&this.tweens.isPlaying()&&this.tweens.stop(),this._cameraTarget.position.add(t),this.dispatchUpdateEvent())}addPosition(t,e,i=!1,s=!1){if(!i){if(!s&&this.tweens.isPlaying())return;if(s&&this.tweens.isPlayingWithKey(t))return}i&&this.tweens.isPlaying()&&this.tweens.stop(),this.pos[t]+=e,this.limiter.clampPosition(t,this.pos),this.dispatchUpdateEvent()}copySphericalPosition(t){return t.copy(this.pos)}cloneSphericalPosition(){return this.pos.clone()}dispose(){n.w.off("tick",this.onTick),this.cameraUpdater.dispose(),this.tweens.stop(),this.removeAllListeners()}}function p(t){return Math.atan2(Math.sin(t),Math.cos(t))}class d{static init(t,e,i=!1){const s={...t??{}};s.duration??=e.tweens.duration;const a=i?e.tweens.loopEasing:e.tweens.easing;return s.easing??=a,s.normalize??=!0,s}}class l{constructor(t,e){this.isUpdate=!1,this.setNeedUpdate=t=>{this.updateEvent=t},this.updatePosition=()=>{if(!this.updateEvent)return;const t=this.updateEvent,e=new a.Pq0,i=this._camera.position;if(i.setFromSpherical(t.position),i.add(t.cameraTarget.getWorldPosition(e)),this._camera.position.set(i.x,i.y,i.z),this._camera.lookAt(t.cameraTarget.getWorldPosition(e)),t.shift){const e=this._camera.position.clone(),i=new a.Pq0(t.shift.x,t.shift.y,t.shift.z);i.applyEuler(this._camera.rotation.clone()),e.add(i),this._camera.position.set(e.x,e.y,e.z)}this.dispatcher.emit("moved_camera",{type:"moved_camera"}),this.updateEvent=void 0},this.dispatcher=t,this._camera=e,this.dispatcher.on("update",this.setNeedUpdate),n.w.on("onBeforeTick",this.updatePosition)}dispose(){this.dispatcher.off("update",this.setNeedUpdate),n.w.off("onBeforeTick",this.updatePosition)}}class m{constructor(){this.phiMin=m.EPS,this.phiMax=Math.PI-m.EPS,this.thetaMin=void 0,this.thetaMax=void 0,this.rMax=Number.MAX_VALUE,this.rMin=m.EPS}setLimit(t,e,i){switch(t){case"phi":this.phiMax=e,this.phiMin=i;break;case"theta":this.thetaMax=e,this.thetaMin=i;break;case"radius":this.rMax=e,this.rMin=i}}clampWithType(t,e){switch(t){case"phi":return m.clamp(e,this.phiMax,this.phiMin);case"theta":return m.clamp(e,this.thetaMax,this.thetaMin);case"radius":return m.clamp(e,this.rMax,this.rMin)}return e}clampPosition(t,e){const i=e[t];e[t]=this.clampWithType(t,i)}static clamp(t,e,i){if(null==i||null==e)return t;const s=Math.min(t,e);return Math.max(s,i)}}m.EPS=1e-6;class u{constructor(){this.tweenMap=new Map,this.duration=1333,this.easing=r.GS.Cubic.Out,this.loopEasing=r.GS.Sinusoidal.InOut}stopTween(t){const e=this.tweenMap.get(t);e&&(e.stop(),this.tweenMap.delete(t))}overrideTween(t,e){this.stopTween(t),e&&this.tweenMap.set(t,e)}isPlaying(){let t=!1;for(const e of this.tweenMap.values())e?.isPlaying()&&(t=!0);return t}isPlayingWithKey(t){const e=this.tweenMap.get(t);return!!e&&e.isPlaying()}stop(){this.tweenMap.forEach(((t,e)=>{e&&this.stopTween(e)}))}update(t){for(const e of this.tweenMap.values())e.update(t.timestamp)}}let w,g,v;let P;const f=(t,e)=>{const i={toggleRandomMove:()=>{null!=P?M(e):y(e)}};t.add(i,"toggleRandomMove")},M=t=>{t.tweens.stop(),clearInterval(P),P=null},y=t=>{const e=()=>{const e=new a.YHV(105,Math.random()*Math.PI,Math.random()*Math.PI*6-3*Math.PI);t.move(e,{duration:1500,easing:r.GS.Cubic.Out}),console.log("Start : ",e)};e(),P=setInterval(e,2e3)},T=(t,e)=>{const i=t.addFolder("add method");i.open(),_("radius",5,i,e),_("radius",-5,i,e),_("phi",.1,i,e),_("phi",-.1,i,e),_("theta",.1,i,e),_("theta",-.1,i,e)},_=(t,e,i,s)=>{const a={};let o=e.toString();e>0&&(o=`+${o}`);const n=t+o;a[n]=()=>{s.addPosition(t,e)},i.add(a,n)},x=(t,e)=>{const i=t.addFolder("loop method");i.open(),E("radius",30,150,i,e),E("phi",0,Math.PI,i,e),E("theta",-Math.PI/4,Math.PI/4,i,e)},E=(t,e,i,s,a)=>{let o=!1;const n={duration:1e4},r=`loop_${t}`,h={};h[r]=()=>{o?a.stopLoop(t):a.loop(t,e,i,n),o=!o},s.add(h,r)};window.onload=()=>{g=new a.Z58,v=function(t,e,i){const s=new a.ubm(45,1.6,1,400);return s.position.set(0,0,100),t.add(s),s}(g),w=function(t,e,i=0,s="webgl-canvas",n=!0){const r=document.getElementById(s);r.style.zIndex=0,r.style.position="absolute";const h=new o.JeP({canvas:r,antialias:n});return h.setClearColor(new a.Q1f(i)),h.setSize(t,e),h.setPixelRatio(window.devicePixelRatio),h}(1280,800),function(t){const e=new a.$p8(16777215,1);t.add(e)}(g),console.log(0===p(0)),console.log(p(Math.PI)===Math.PI),console.log(p(-Math.PI)===-Math.PI),console.log(p(2*Math.PI)),console.log(p(Math.PI+.01)===.01-Math.PI),console.log(Math.abs(p(200*Math.PI+.01)-.01)<1e-6),function(t,e=30){const i=new a.IzY(e);t.add(i)}(g),function(t,e=5){const i=t=>new a.V9B({color:t,opacity:.5,transparent:!0,wireframe:!0}),s=new a.iNn(e,e,e),o=[i(65280),i(16711680),i(255),i(65280),i(16711680),i(255)],n=new a.eaF(s,o);t.add(n)}(g);const t=function(){const t=new a.Gu$(1,3,3),e=new a.V9B({color:16711680,opacity:0,transparent:!0});return new a.eaF(t,e)}();g.add(t);const e=((t,e)=>{const i=new c(v,t);return i.initCameraPosition(new a.YHV(e,1e-4,2*Math.PI*12)),i.initCameraShift(new a.Pq0(20,0,0)),i.duration=1666,i.on("moved_camera_complete",(t=>{console.log("Complete : ",t)})),i})(t,105);(t=>{setInterval((()=>{console.log(t.tweens.isPlaying())}),100)})(e),function(t,e,i){const s=()=>{t.render(e,i),requestAnimationFrame(s)};s()}(w,g,v),(t=>{const e=new s.Ay;f(e,t),T(e,t),x(e,t)})(e)}}},i={};function s(t){var a=i[t];if(void 0!==a)return a.exports;var o=i[t]={exports:{}};return e[t](o,o.exports,s),o.exports}s.m=e,t=[],s.O=(e,i,a,o)=>{if(!i){var n=1/0;for(p=0;p<t.length;p++){for(var[i,a,o]=t[p],r=!0,h=0;h<i.length;h++)(!1&o||n>=o)&&Object.keys(s.O).every((t=>s.O[t](i[h])))?i.splice(h--,1):(r=!1,o<n&&(n=o));if(r){t.splice(p--,1);var c=a();void 0!==c&&(e=c)}}return e}o=o||0;for(var p=t.length;p>0&&t[p-1][2]>o;p--)t[p]=t[p-1];t[p]=[i,a,o]},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={558:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var a,o,[n,r,h]=i,c=0;if(n.some((e=>0!==t[e]))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(h)var p=h(s)}for(e&&e(i);c<n.length;c++)o=n[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(p)},i=self.webpackChunk_masatomakino_threejs_spherical_controls=self.webpackChunk_masatomakino_threejs_spherical_controls||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=s.O(void 0,[121],(()=>s(782)));a=s.O(a)})();